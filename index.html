<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SYNAP — Welcome</title>
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container" id="app">
  <header>
    <div class="logo">
      <div class="mark">S</div>
      <div>
        <div style="font-weight:800">SYNAP</div>
        <div style="font-size:12px;color:var(--muted)">A narrative tactical experience</div>
      </div>
    </div>
    <nav class="nav" role="tablist" aria-label="Main">
      <button id="tab-home" class="active" role="tab" aria-selected="true">Home</button>
      <button id="tab-about" role="tab">About the Game</button>
      <button id="tab-story" role="tab">Story</button>
    </nav>
  </header>

  <main>
    <section class="hero hero-center" id="home-panel">
      <div style="width:100%;text-align:center">
        <h1 class="hero-title">SYNAP</h1>
        <p class="hero-subtitle">State Your Name And Purpose</p>
        <div class="hero-cta"><button class="cta" onclick="showTab('tab-story')">Enter the Story</button></div>
      </div>
    </section>

    <section class="tabs" id="about-panel" style="display:none">
      <h3 style="margin:0 0 8px;font-family:Merriweather,serif;color:var(--accent)">About the Game</h3>
      <div class="about">
        <p><strong>SYNAP</strong> RPG Dungeon Crawler each character is IMMORTAL lols</p>
        <ul>
          <li>Play with unique Roles and Synergies</li>
          <li>Rich character lore across 11 chapters</li>
          <li>Combat clip integration + stat readouts</li>
        </ul>
      </div>
    </section>

    <section class="tabs" id="story-panel" style="display:none">
      <div class="reader">
        <aside class="chapters-list" aria-label="Chapters">
          <h3>Chapters</h3>
          <div id="chapter-list"></div>
        </aside>

        <article class="reader-pane" id="reader" aria-live="polite">
          <div class="book-title">
            <div class="char-icon" id="char-icon">Icon</div>
            <div class="chapter-meta">
              <h2 id="chapter-title">Chapter 0 — Name</h2>
              <div class="subtitle" id="chapter-subtitle">Character role / short tagline</div>
            </div>
          </div>

          <div class="story-text" id="story-text">
            <span class="dropcap" id="dropcap">W</span>
            <div id="story-body">Replace with story content. This section is where you paste the narrative of the character. It's styled to feel like a book — ample line-height and a serif typeface.</div>
          </div>

          <div class="stats" id="stats">
            <h4>Stats</h4>
            <ul id="stats-list">
              <!-- Stats inserted here -->
            </ul>
          </div>

          <div class="optimal-lineup" id="optimal-lineup" style="margin-top:12px;">
            <h4>Optimal Lineups</h4>
            <div id="optimal-list" class="lineup" style="display:flex;gap:10px;flex-wrap:wrap"></div>
          </div>

          <div class="attacks">
            <div>
              <div class="attack-card">
                <h4>Basic Attack</h4>
                <p class="attack-desc" id="basic-desc">Short description of the Basic Attack goes here.</p>
              </div>

              <div class="attack-card" style="margin-top:12px;">
                <h4>Skill</h4>
                <p class="attack-desc" id="skill-desc">Short description of the Skill goes here.</p>
                <div id="skill-cooldown" class="skill-cooldown" style="display:none">Cooldown: 0s</div>
              </div>
            </div>

            <aside style="display:flex;flex-direction:column;gap:12px">
              <div class="video-wrap">
                <label style="font-weight:700;font-size:13px">Basic Attack — Combat Clip</label>
                <video id="video-basic" controls preload="none" poster="" src="">
                  <!-- Replace src with your clip file -->
                  Your browser does not support the <code>video</code> element.
                </video>
              </div>

              <div class="video-wrap">
                <label style="font-weight:700;font-size:13px">Skill — Combat Clip</label>
                <video id="video-skill" controls preload="none" poster="" src="">
                  <!-- Replace src with your clip file -->
                  Your browser does not support the <code>video</code> element.
                </video>
              </div>
            </aside>
          </div>

          <div class="controls">
            <button class="btn" id="prev-btn">← Prev</button>
            <button class="btn" id="next-btn">Next →</button>
            <div style="flex:1"></div>
            <button class="btn" id="toggle-list">Toggle Chapters</button>
          </div>

          <div class="chapter-footer">
            <div id="chapter-counter">Chapter 0 of 10</div>
            <div style="font-size:12px;color:var(--muted)">Use ← / → keys to navigate</div>
          </div>
        </article>
      </div>
    </section>
  </main>
</div>

<script>
  // Chapter data: fill in your character details & story text here.
  const chapters = [
    {
      id: 0,
      title: "Chapter 0 — SYNAP",
      subtitle: "The Promise of Forever",
      characterName: "SYNAP",
      image: "",
      story: "------",
      stats: { },
      basic: { desc: "—", video: "" },
      skill: { desc: "—", video: "" },
      optimalLineup: []
    },
    {
      id: 1,
      title: "Chapter 1 — Eury",
      subtitle: "The Fate of Eurelia",
      characterName: "Eury",
      image: "Icons/Eury-face.png",
      story: "Her Story is still being written... Come back later.",
      stats: { HP: "200", Role: "On-Field Bruiser", Description: "Projectile Based Combattant Damaging First Enemy on HIT" },
      basic: { desc: "3 Step Combo Dealing 10,10,15 Damage", video: "" },
      skill: { desc: "Projectile Dealing 22 Damage on First Enemy HIT", video: "", cooldown: 5 },
      optimalLineup: ["Eury","Pocholo","Epsilese"]
    },
    {
      id: 2,
      title: "Chapter 2 — Pocholo",
      subtitle: "The Deal with the Disguised Devil",
      characterName: "Pocholo",
      image: "Icons/Pocholo-face.png",
      story: "“Another day, another distraction—\nDon’t let it get to you.\nDon’t let it get to you.”\n\nPocholo lived a simple life on paper. An astute businessman, sharp in thought and quicker in decision, he believed success was earned by staying ahead—by never looking back. All his decisions, to gain him the upper hand. And so, when he was lent a hand from the Gods, he wouldn't be foolish enough to reject that.\n\nAnd so Jiapetus, The God of Mortality bestowed him these words: “You shall walk endlessly forward. And your past shall trail behind you, voiceless yet ever-present. \n\nThe echoes of your choices will follow, but never touch you. Hear them if you must— but do not let them stop you.”\n\nAnd so Pocholo was made undying.\n\nYet immortality did not erase his past—it preserved it. the past when he deceived his way to the top. when he took all the merit away from his business partner, it was to get ahead. Always was,  always has been.\n\nEvery failure and every wrong decision trails his mind. whispering just beyond reach. The voices could not harm him, could not alter his path, but they followed. They persist as long as Pocholo exists and he knew that. \n\n“Don’t let it get to you,” he would say, louder each time.\n\nHe continued to thrive. His decisions grew colder, cleaner, sharper. After all—nothing held him back. Not guilt. Not grief. Not memory. Or so he believed.\n\nBut what is a life without reckoning? \nWhat is eternity when the past is never faced, only outrun?\nThe echoes never faded. They multiplied.\n\nAnd for the first time, Pocholo wondered whether immortality was not freedom—but avoidance given infinite time.\n\n\"I've lived a long life, and witnessed every loss.\nYet why are the echoes of my wins inaudible amidst the cacophonies of which i've done wrong?\nIn this forever-locked room the silence remains loud, And regret bounces off it's walls. Perhaps, it's time to let down these walls and face what's outside.\"",
      stats: { HP: "200", Role: "Shielder", Description: "A sly duelist who manipulates tempo and trades." },
      basic: { desc: "2 Step QUICK Combo Dealing 9,11 Damage", video: "" },
      skill: { desc: "Quick Ready Shield Numbing 3 Hits, Lasting until 3 Hits are Depleted", video: "", cooldown: 8 },
      optimalLineup: ["Eury","Pocholo","Epsilese"]
    },
    {
      id: 3,
      title: "Chapter 3 — Ethos",
      subtitle: "The Fairklord Name Eternal",
      characterName: "Ethos",
      image: "Icons/Ethos-face.png",
      story: "“Fairklord—we were once geniuses, I tell you.\nAnd the name will last forever with me…\nI tell myself that—\nBut no one remembers my name.”\n\nThe Fairklord name was once synonymous with brilliance. Inventors without equal, architects of weapons both magnificence and devastation, their creations reshaped battlefields. Explosives that could end wars in moments—that was the handiwork of Ethos Fairklord. \n\nYet invention moved faster than memory, His designs were replicated, refined, surpassed. His name faded from schematics, replaced by newer signatures, cleaner marks. What endured were the tools—not the hands that forged them. The Fairklord name remained, but it became diluted, spoken as history rather than honor.\n\nEthos could not accept this, so he sought the God that can preserve his name, his story.\n\nAnd so Jiapetus, The God of Mortality bestowed him these words: “The creator will die just like their creations do,\nWe live to tell tales of what was past, \nbut if you insist to stay eternal, i would not stop you, \nthough tell me this:\nwould you not be contempt to know you were a part of something grand? or would you rather chase eternally to be the meaning of grand itself?”\n\nHe believed time would vindicate him. That centuries would solidify his worth. That living longer meant being remembered longer.\n\nBut eternity does not preserve value—it erodes it.\n\nEthos lived to see his inventions become commonplace. He was great, but great alone cannot compete against the aspirations of young minds. He was the blueprint, he cannot accept that. Ethos kept honing, he kept watching as the world shifted and greatness gets passed. In a world where everyone could leave something behind, nothing stayed precious. Greatness became renewable. Legacy became noise.\n\nAnd Ethos, eternal and irrelevant, finally understood:\n\"To live forever was not to secure value— it was to watch it decay.\nIf only i left it all behind in the place knowing that if i kept chasing to find better, then i will find nothing.. The world continues to evolve, no one can be great forever\"",
      stats: { HP: "400", Role: "On-Field Skill-Based", Description: "Loses HP to deal Massive AREA damage" },
      basic: { desc: "2 Step Combo Dealing 6,7 Damage", video: "" },
      skill: { desc: "Loses 10 HP to Deal 35 Damage to Every enemy Around", video: "", cooldown: 12 },
      optimalLineup: ["Keyser","Hedler","Ethos"]
    },
    {
      id: 4,
      title: "Chapter 4 — Simone",
      subtitle: "Never Withered, Never Lost",
      characterName: "Simone",
      image: "Icons/Simone-face.png",
      story: "Her Story is still being written... Come back later.",
      stats: { HP: "200", Role: "On-Field Bruiser", Description: "A stalwart who anchors frontline engagements." },
      basic: { desc: "3 Step Combo Dealing 7,8,15 Damage", video: "" },
      skill: { desc: "Shoots All Enemies Airborne dealing 25 Damage", video: "", cooldown: 3.5 },
      optimalLineup: ["Keyser","Hedler","Simone"]
    },
    {
      id: 5,
      title: "Chapter 5 — Mackos",
      subtitle: "Console.log(\"Mackos Embedded\")",
      characterName: "Mackos",
      image: "Icons/Mackos-face.png",
      story: "His Story is still being written... Come back later.",
      stats: { HP: "195", Role: "Off-Field Burn", Description: "An embedded thinker, bringing gadgets to the battlefield." },
      basic: { desc: "This Character is Not Playable", video: "" },
      skill: { desc: "This Character is Not Playable", video: "", cooldown: 11 },
      optimalLineup: []
    },
    {
      id: 6,
      title: "Chapter 6 — Epsilese",
      subtitle: "For She Has Already Shut Her Eyes",
      characterName: "Epsilese",
      image: "Icons/Epsilese-Face.png",
      story: "Her Story is still being written... Come back later.",
      stats: { HP: "180", Role: "Summoner", Description: "Status Splash Splash" },
      basic: { desc: "2 Step Combo Dealing 8, 12 Damage", video: "" },
      skill: { desc: "Summons Area Pulsing Jellyfishes Dealing AOE damage (5,7) and Applying Soaked Debuff every (0.8s,1s), If enemy got Soaked 3 times, they have lower resistance", video: "", cooldown: 8 },
      optimalLineup: ["Eury","Pocholo","Epsilese"]
    },
    {
      id: 7,
      title: "Chapter 7 — Hedler",
      subtitle: "When the Beacon runs Dim",
      characterName: "Hedler",
      image: "Icons/Hedler-Face.png",
      story: "\"Let me be your beacon— The light that keeps you going. Yet light only serves in the dark— if it's not? It's an afterthought.\"\n\nHedler was once an apprentice who believed guidance was salvation. While under his master's guidance, he learned that light existed to lead the lost, to stand where others could not. When the offer of immortality came, it was framed as duty— a necessary sacrifice to shine forever. Trusting his master’s will, Hedler surrendered his mortality without protest.\n\nJiapetus, The God of Mortality bestowed him these words: \"You shall be the Beacon that guides people and nothing more, Let the moths not flyeth close to thee, or they may never soar another day, Be their guide and nothing more.\"\n\nWhat this entailed to him, is that he was cursed to be a \"lightkeeper\", anyone who gets close to him shall be burnt away— shortly after, this included his master.\n\nThe alluring light draws you near, he is of course, a light that charms anyone who needs guidance. Since then, Hedler has stood alone, watched by countless eyes yet untouched by any hand. Mortals are drawn to him in moments of despair, mistaking his glow for refuge. He leads them safely through the dark without uttering a word. Each departure leaves him more fulfilled yet somehow.... emptier.\n\nWho does a beacon turn to when it begins to flicker?—Must they burn away and leave more sorrow?\n\nHedler closed his eyes— not to rest, but to endure. If he could no longer look upon those who would be harmed by his light, perhaps the pain would dull. He waits for the day his radiance fades, when the flame that defines him finally dims, Perhaps it is selfish to long for intimacy, regardless...\n\n\"My eyes are shut— i will no longer look, and when the time comes when the beacon runs dim. they will look no more, and burn no longer.\"",
      stats: { HP: "200", Role: "AOE Off-Field", Description: "Lantern BRRRRRRRR" },
      basic: { desc: "3 Step Combo Dealing 8,10,20 Damage, 3rd Hit aims upwards", video: "" },
      skill: { desc: "Summons a Lantern at a fixed Location dealing 5 Damage Every 0.4s for 7.5s", video: "", cooldown: 8 },
      optimalLineup: ["Keyser","Hedler","Simone"]
    },
    {
      id: 8,
      title: "Chapter 8 — Ferriols",
      subtitle: "Of Passion and Fury, Of Gods and Glory",
      characterName: "Ferriols",
      image: "Icons/Ferriols-face.png",
      story: "Her Story is still being written... Come back later.",
      stats: { HP: "280", Role: "Berserker", Description: "Fierce offense that Spams Skill dealing a Final Stronger Blow" },
      basic: { desc: "This Character is Not Playable", video: "" },
      skill: { desc: "This Character is Not Playable", video: "", cooldown: 10 },
      optimalLineup: []
    },
    {
      id: 9,
      title: "Chapter 9 — Fidyr",
      subtitle: "Requiems for the Lost, Ode to the Executed",
      characterName: "Fidyr",
      image: "Icons/Fidyr-face.png",
      story: "Her Story is still being written... Come back later.-",
      stats: { HP: "150", Role: "Leech", Description: "A cold precision killer who thrives on perfect trades." },
      basic: { desc: "This Character is Not Playable", video: "" },
      skill: { desc: "This Character is Not Playable", video: "", cooldown: 7 },
      optimalLineup: []
    },
    {
      id: 10,
      title: "Chapter 10 — Keyser",
      subtitle: "The Legacy of the Golden Child",
      characterName: "Keyser",
      image: "Icons/Keyser-Face.png",
      story: "His Story is still being written... Come back later.",
      stats: { HP: "250", Role: "Shielder", Description: "Gold" },
      basic: { desc: "3 Step Combo Dealing 8,9,10 Damage", video: "videos/Keyser-Basic.mp4" },
      skill: { desc: "AOE Damage dealing 12 Damage proceeded by a 6 second immunity Shield", video: "videos/Keyser-Skill.mp4", cooldown: 15 },
      optimalLineup: ["Keyser","Hedler","Simone"]
    }
  ];

  // If you haven't added all 11 yet, this helper will ensure we still have placeholders to show navigation up to 10.
  for (let i = chapters.length; i <= 10; i++) {
    chapters[i] = chapters[i] || {
      id: i,
      title: `Chapter ${i} — [Character ${i}]`,
      subtitle: "Role · [tagline]",
      characterName: `[Character ${i}]`,
      image: "",
      story: `Story text for Chapter ${i} — replace this with the real narrative.`,
      stats: { HP: "—", Role: "—" },
      basic: { desc: "Basic Attack description.", video: "" },
      skill: { desc: "Skill description.", video: "" }
    };
  }

  // DOM refs
  const listEl = document.getElementById('chapter-list');
  const titleEl = document.getElementById('chapter-title');
  const subtitleEl = document.getElementById('chapter-subtitle');
  const iconEl = document.getElementById('char-icon');
  const storyBodyEl = document.getElementById('story-body');
  const dropcapEl = document.getElementById('dropcap');
  const statsListEl = document.getElementById('stats-list');
  const basicDesc = document.getElementById('basic-desc');
  const skillDesc = document.getElementById('skill-desc');
  const skillCooldownEl = document.getElementById('skill-cooldown');
  const videoBasic = document.getElementById('video-basic');
  const videoSkill = document.getElementById('video-skill');
  const chapterCounter = document.getElementById('chapter-counter');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const toggleListBtn = document.getElementById('toggle-list');

  // Tabs
  const tabs = {
    home: document.getElementById('home-panel'),
    about: document.getElementById('about-panel'),
    story: document.getElementById('story-panel')
  };
  const tabButtons = {
    home: document.getElementById('tab-home'),
    about: document.getElementById('tab-about'),
    story: document.getElementById('tab-story')
  };
  function showTab(tabId){
    // hide all
    tabs.home.style.display = 'none';
    tabs.about.style.display = 'none';
    tabs.story.style.display = 'none';
    tabButtons.home.classList.remove('active');
    tabButtons.about.classList.remove('active');
    tabButtons.story.classList.remove('active');
    // show
    if(tabId === 'tab-about') { tabs.about.style.display='block'; tabButtons.about.classList.add('active');}
    else if(tabId === 'tab-story') { tabs.story.style.display='block'; tabButtons.story.classList.add('active');}
    else { tabs.home.style.display='flex'; tabButtons.home.classList.add('active'); }
  }
  tabButtons.home.addEventListener('click', ()=>showTab('tab-home'));
  tabButtons.about.addEventListener('click', ()=>showTab('tab-about'));
  tabButtons.story.addEventListener('click', ()=>showTab('tab-story'));

  // Build chapter list
  let current = 0;
  function renderChapterList(){
    listEl.innerHTML = '';
    chapters.forEach(ch => {
      const a = document.createElement('button');
      a.className = 'chapter-item';
      // Format like: "Chapter 1: Eury — The Fate of Eurelia"
      a.textContent = `Chapter ${ch.id}: ${ch.characterName} — ${ch.subtitle}`;
      a.setAttribute('data-id', ch.id);
      a.onclick = ()=>goToChapter(ch.id);
      if(ch.id === current) a.classList.add('active');
      listEl.appendChild(a);
    });
  }

  function renderChapter(idx){
    const ch = chapters[idx];
    if(!ch) return;
    titleEl.textContent = ch.title;
    // surround subtitle with dashes for the "book" feel
    subtitleEl.textContent = `--- ${ch.subtitle} ---`;

    // icon: use image or fallback to initials
    if(ch.image){
      iconEl.style.backgroundImage = `url('${ch.image}')`;
      iconEl.style.backgroundSize = 'cover';
      iconEl.textContent = '';
    } else {
      iconEl.style.backgroundImage = 'none';
      iconEl.textContent = ch.characterName ? ch.characterName.split(' ').map(s=>s[0]).join('').slice(0,2) : 'Ic';
    }

    // story
    const raw = ch.story || '';
    const trimmedText = raw.trim();
    const firstChar = trimmedText.charAt(0) || '';
    dropcapEl.textContent = firstChar;

    // split into paragraphs by blank lines and trim
    const paras = trimmedText.split(/\n\s*\n/).map(p=>p.trim());
    // remove first char from first paragraph to avoid duplicating after the dropcap
    if(paras.length && paras[0].length){
      paras[0] = paras[0].slice(1).trimStart();
    }

    // convert paragraphs to HTML; quoted paragraphs become blockquotes
    const html = paras.map(p => {
      if(!p) return '';
      if(/^['"“]/.test(p)){
        const inner = p.replace(/^['"“]+|['"”]+$/g,'').trim();
        return `<blockquote>${inner}</blockquote>`;
      }
      return `<p>${p}</p>`;
    }).join('');

    storyBodyEl.innerHTML = html;

    // Chapter 0 special case: full text only
    const statsContainer = document.getElementById('stats');
    const attacksEl = document.querySelector('.attacks');
    const controlsEl = document.querySelector('.controls');

    if(ch.id === 0){
      // hide peripheral UI
      statsContainer.style.display = 'none';
      document.getElementById('optimal-lineup').style.display = 'none';
      attacksEl.style.display = 'none';
      controlsEl.style.display = 'none';
      // make story feel like a long wall of text
      document.getElementById('reader').classList.add('chapter0');
    } else {
      statsContainer.style.display = '';
      document.getElementById('optimal-lineup').style.display = '';
      attacksEl.style.display = '';
      controlsEl.style.display = '';
      document.getElementById('reader').classList.remove('chapter0');
    }

    // stats
    statsListEl.innerHTML = '';

    if(ch.stats && ch.id !== 0){
      for(const [k,v] of Object.entries(ch.stats)){
        if(k.toLowerCase() === 'description') continue; // handle separately
        const li = document.createElement('li');
        li.className = 'stat-item';
        li.innerHTML = `<strong>${k}:</strong> ${v}`;
        statsListEl.appendChild(li);
      }
      // description (optional)
      const prevDesc = statsContainer.querySelector('.desc');
      if(prevDesc) prevDesc.remove();
      if(ch.stats.Description){
        const p = document.createElement('div');
        p.className = 'desc';
        p.textContent = ch.stats.Description;
        statsContainer.appendChild(p);
      }
    }

    // attacks
    basicDesc.textContent = ch.basic && ch.basic.desc ? ch.basic.desc : '';
    skillDesc.textContent = ch.skill && ch.skill.desc ? ch.skill.desc : '';

    // skill cooldown display
    if(ch.skill && typeof ch.skill.cooldown !== 'undefined' && ch.id !== 0){
      skillCooldownEl.style.display = 'block';
      skillCooldownEl.textContent = `Cooldown: ${ch.skill.cooldown}s`;
    } else {
      skillCooldownEl.style.display = 'none';
    }

    // videos (hide on chapter 0)
    if(ch.id !== 0 && ch.basic && ch.basic.video){
      videoBasic.src = ch.basic.video;
      videoBasic.poster = '';
      videoBasic.style.display = 'block';
    } else {
      videoBasic.src = '';
      videoBasic.style.display = 'none';
    }
    if(ch.id !== 0 && ch.skill && ch.skill.video){
      videoSkill.src = ch.skill.video;
      videoSkill.poster = '';
      videoSkill.style.display = 'block';
    } else {
      videoSkill.src = '';
      videoSkill.style.display = 'none';
    }

    // Optimal lineup
    const optimalEl = document.getElementById('optimal-list');
    optimalEl.innerHTML = '';
    if(ch.optimalLineup && ch.optimalLineup.length && ch.id !== 0){
      document.getElementById('optimal-lineup').style.display = 'block';
      ch.optimalLineup.forEach(name => {
        const member = document.createElement('button');
        member.className = 'member';
        // find chapter by name (case-insensitive)
        const target = chapters.find(c => c.characterName && c.characterName.toLowerCase() === name.toLowerCase());
        if(target && target.image){
          const img = document.createElement('img');
          img.src = target.image;
          img.alt = name;
          img.style.width = '100%';
          img.style.height = '100%';
          img.style.objectFit = 'cover';
          member.appendChild(img);
        } else {
          // fallback to initials
          member.textContent = name.split(' ').map(s=>s[0]).join('').slice(0,2);
        }
        member.title = name;
        member.onclick = ()=>{
          if(target) goToChapter(target.id);
        };
        optimalEl.appendChild(member);
      });
    } else {
      document.getElementById('optimal-lineup').style.display = 'none';
    }

    // counter and list active style
    chapterCounter.textContent = `Chapter ${ch.id} of 10`;
    document.querySelectorAll('.chapter-item').forEach(btn=>btn.classList.remove('active'));
    const activeBtn = document.querySelector(`.chapter-item[data-id='${idx}']`);
    if(activeBtn) activeBtn.classList.add('active');
  }

  function goToChapter(idx){
    if(idx < 0) idx = 0;
    if(idx > 10) idx = 10;
    current = idx;
    renderChapter(current);
    // focus the reader for keyboard support
    document.getElementById('reader').focus();
  }

  // Prev / Next
  prevBtn.addEventListener('click', ()=>goToChapter(Math.max(0, current-1)));
  nextBtn.addEventListener('click', ()=>goToChapter(Math.min(10, current+1)));
  // Keyboard navigation
  document.addEventListener('keydown', (e)=>{
    if(document.getElementById('story-panel').style.display === 'block'){
      if(e.key === 'ArrowLeft') goToChapter(Math.max(0, current-1));
      if(e.key === 'ArrowRight') goToChapter(Math.min(10, current+1));
    }
  });

  // Toggle list (useful on mobile)
  toggleListBtn.addEventListener('click', ()=>{
    const list = document.querySelector('.chapters-list');
    list.style.display = list.style.display === 'none' ? 'block' : 'none';
  });

  // initialize
  renderChapterList();
  goToChapter(0);
  // default show home tab
  showTab('tab-home');

  // Expose some helpers to console for quick editing:
  window.SYNAP = {
    chapters,
    goToChapter,
    renderChapterList,
    renderChapter
  };
</script>
</body>
</html>